$schema: 'http://json-schema.org/draft-04/schema#'
id: libofp
description: >
  Schema for Libofp messages.

yamlschema_examples: |
  ---
  event: LIBOFP_LOOPBACK
  params:
    data: abcdef
    validate: true
  ---
  event: LIBOFP_LISTEN_REQUEST
  params:
    xid: 1
    endpoint: 127.0.0.1:6654
  ---
  event: LIBOFP_LISTEN_REPLY
  params:
    xid: 1
    endpoint: 127.0.0.1:6654
    error: An error occurred.
  ---
  event: LIBOFP_CONNECT_REQUEST
  params:
    xid: 1
    endpoint: 127.0.0.1:6654
  ---
  event: LIBOFP_CONNECT_REPLY
  params:
    xid: 1
    endpoint: 127.0.0.1:6654
    error: An error occurred.
  ---
  event: LIBOFP_YAML_ERROR
  params:
    error: error string
    text: original message
  ---
  event: LIBOFP_DECODE_ERROR
  params:
    datapath_id: xx
    error: error string
    data: original message
  ---
  event: LIBOFP_DATAPATH_UP
  params:
    datapath_id: xx
    endpoint: xx
    version: xx
  ---
  event: LIBOFP_DATAPATH_DOWN
  params:
    datapath_id: xx
    endpoint: xx
    version: xx
  ---
  event: LIBOFP_TIMER
  params:
    datapath_id: xx
    timer_id: xx
  ---
  event: LIBOFP_SET_TIMER
  params:
    datapath_id: xx
    timer_id: xx
    timeout: xx
  ---
  event: LIBOFP_EDIT_SETTING
  params:
    name: xx
    value: xx
  ---

type: object
oneOf: 
  - {$ref: '#/definitions/libofp_loopback'}
  - {$ref: '#/definitions/libofp_listen_request'}



definitions:

  libofp_loopback:
    properties: 
      event: {enum: [LIBOFP_LOOPBACK]}
      params: 
        properties: 
          data: {$ref: 'types#/binary'}
          validate: {type: boolean}
        required: [data]

  libofp_listen_request:
    properties:
      event: {enum: [LIBOFP_LISTEN_REQUEST]}
      params:
        properties:
            xid: {$ref: 'types#/uint32'}
            endpoint: {$ref: 'types#/ipv6endpoint'}
        required: [xid, endpoint]
